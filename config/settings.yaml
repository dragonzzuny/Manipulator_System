# AMR + 로봇 팔 + 비전 통합 시스템 설정 파일

# 로봇 팔 설정
robot:
  ip: "192.168.58.2"
  gripper:
    open_width_mm: 30.0
    jaw_length_mm: 15.0
    jaw_thickness_mm: 7.0
    depth: 30.0
    approach_clearance: 10.0
  
  # 조인트 위치 (degree)
  joints:
    home: [45.568, -127.937, 121.293, -83.629, -90.169, -1.238]
    vision_scan: [46.257, -39.095, 41.934, -93.115, -90.168, -0.548]
    down: [47.568, -127.937, 121.293, -83.629, -90.169, -1.238]
  
  # Z축 오프셋 및 조정값
  offsets:
    camera_z_offset: 180.0
    grasp_depth_adjust: 20.0
    approach_height: 100.0
    camera_base_offset_deg: 136.0
    y_offset: -68.0
  
  # 작업 공간 제한
  workspace:
    x_limit: 800
    y_limit: 800
    z_min: -50
    z_max: 400

# AMR 설정
amr:
  host: "192.168.58.10"
  move_threshold: 0.01
  check_interval: 1.0
  max_wait_time: 300
  stop_count_threshold: 60
  
  # AMR 지점 이름
  points:
    grab: "Grab_point"
    release: "Release_point"
    start: "Charging_point"

# 비전 시스템 설정
vision:
  # 모델 경로 (Windows 경로 - 필요시 수정)
  models:
    segmentation: "C:/Users/FAIR/Desktop/main/test_folder/20250925_201843/20250925_201843/segmentation/weights/best.pt"
    keypoint: "C:/Users/FAIR/Desktop/main/test_folder/20250925_201843/20250925_201843/keypoint/weights/best.pt"
  
  # 카메라 설정
  camera:
    width: 640
    height: 480
    fps: 30
    warmup_frames: 30
    multi_frame_count: 5
    frame_delay: 0.05
  
  # 탐지 파라미터
  detection:
    confidence_threshold: 0.5
    min_vector_distance: 5.0
    min_inside_score: 30
    roi_radius_factor: 0.5
    search_step: 1
    
  # 안전 마스크 침식 설정
  safety_mask:
    primary_erosion_kernel: 11  # 5px 침식
    secondary_erosion_kernel: 7  # 3px 침식
    min_safe_area_primary: 100
    min_safe_area_secondary: 50
    
  # 파지 점수 가중치
  scoring:
    distance_penalty_weight: 0.3
    collision_penalty_weight: 3.0
    edge_bonus_weight: 20.0
    angle_confidence_threshold: 50.0

# 재시도 정책
retry_policy:
  vision_max_retries: 5
  quick_redetect_attempts: 3
  pick_max_attempts: 3
  gripper_verification_attempts: 3
  
# 시스템 설정
system:
  enable_debug_capture: false
  save_dir: "./vector_test_cap"
  log_file: "./logs/system.log"
  log_level: "INFO"
  
  # 대기 시간
  timing:
    capture_wait: 2.0
    analysis_display: 3.0
    gripper_close_wait: 1.5
    post_pick_wait: 2.0

# 캘리브레이션 행렬
calibration:
  matrix: [
    [0.7071, 0.7071, 0, 0],
    [0.7071, -0.7071, 0, 0],
    [0, 0, 1, 0],
    [0, 0, 0, 1]
  ]